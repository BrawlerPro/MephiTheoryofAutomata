# Вариант 60 (\*\*\*)

**Система управления клеточным роботом**

Клетка лабиринта имеет форму квадрата. Робот может передвинуться в соседнюю клетку в случае отсутствия в ней препятствия.

## 1. Формальный язык описания действий

Поддерживаются следующие литералы, операторы и конструкции:

### Литералы

* **Знаковые целочисленные** в десятичном формате.
* **Логические**: `TRUE`, `FALSE` (преобразуются в целые `1` и `0`). Обратное преобразование не определено.

### Объявление переменных

* `INT <имя> = <арифметическое выражение>` — целочисленная переменная.
* `BOOLEAN <имя> = <логическое выражение>` — логическая переменная.
* `MAP <имя>` — карта мира.

### Объявление констант

* `CINT <имя> = <арифметическое выражение>` — целочисленная константа.
* `CBOOLEAN <имя> = <логическое выражение>` — логическая константа.

*Строгая типизация: если преобразование не определено или типы не совпадают — семантическая ошибка.*

### Операторы

* **Присваивание**: `:=`.
* **Арифметические** (результат инкремента/декремента первого операнда):

  * `INC <выражение> <операнд>` — инкремент.
  * `DEC <выражение> <операнд>` — декремент.
* **Логические** (результат — логическое значение):

  * `NOT <логическое выражение|вызов процедуры>`.
  * `OR <логическое выражение|вызов> <логическое выражение|вызов>`.
* **Сравнения**:

  * `GT <арг. выражение> <арг. выражение>` (>
  * `LT <арг. выражение> <арг. выражение>` (<)

> Все операторы равноприоритетны: скобки не используются (см. обратную польскую запись).

### Управление потоком

* **Цикл**: `WHILE <логическое выражение> DO <предложение|группа>`
* **Условие**: `IF <логическое выражение> <предложение|группа> [ELSE <предложение|группа>]`
* **Группировка**: круглые скобки `( ... )`.

### Операторы робота

* `STEP` — переместиться на одну клетку вперед (возвращает `TRUE` при успехе, иначе `FALSE`).
* `BACK`, `LEFT`, `RIGHT` — поворот робота соответственно.
* `LOOK` — вернуть количество клеток до первого препятствия впереди.

### Процедуры

* **Объявление**:

  ```
  PROC <имя> [<параметры>]
    <блок>
  ```

  Параметры передаются по ссылке; область видимости — локальная.
* **Вызов**:

  ```
  <имя> [<аргументы>]
  ```

  При использовании в выражениях результат — первый параметр подходящего типа.

### Работа с картой

Вызов оператора как процедуры с четырьмя параметрами: `<результат>, <карта>, X, Y`:

* `BAR` — проверить наличие препятствия.
* `EMP` — проверить отсутствие препятствия.
* `SET` — установить препятствие (1) или свободную клетку (0).
* `CLR` — сбросить состояние клетки в неопределённое.

> Предложение языка завершается переводом строки. Язык регистронезависим.

---

## 2. Интерпретатор (Flex + Yacc)

* Реализовать лексический анализ на Flex.
* Реализовать синтаксический анализ и генерацию AST на Yacc.
* Обеспечить семантический контроль (недопустимые операции над константами, несоответствие типов и т.п.).
* Грамматика должна быть максимально однозначной.

---

## 3. Программа поиска выхода

На разработанном языке написать скрипт, который:

1. Загружает описание лабиринта (текстовый файл с картой и старт/финиш).
2. Управляет роботом для поиска пути к выходу.

**Описание формата файла**:

```
W H          # ширина и высота
X Y          # 'S' — стартовые координаты
X Y          # Координаты конца лабиринта
<строки H символов>  # '1' — стена, '0' — свободно,
```

Пример лабиринта и программы(алгоритм правой руки):

```
7 7
1 1
5 1
1111111
1001001
1011001
1010001
1010111
1000001
1111111

```
```commandline
// Бесконечный цикл: будет прерван автоматически при достижении выхода
WHILE TRUE DO (
    // 1) Повернуть направо и посмотреть вперёд
    RIGHT
    IF GT(LOOK, 0) (
        // если свободно — шагнуть
        STEP
    ) ELSE (
        // иначе вернуть ориентацию на исходную (повернуть влево)
        LEFT

        // 2) Попытаться идти прямо
        IF GT(LOOK, 0) (
            STEP
        ) ELSE (
            // иначе повернуть влево (итого 90° влево от исходного)
            LEFT

            // 3) Попробовать ещё раз
            IF GT(LOOK, 0) (
                STEP
            ) ELSE (
                // 4) Если и слева стена — разворот на 180° и шаг назад
                LEFT
                STEP
            )
        )
    )
)

```

---

*Конец спецификации.*
